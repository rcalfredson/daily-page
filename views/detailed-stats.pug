extends layout

block nav
  include navLinks

block append head
  link(rel='stylesheet', href='/css/detailed-stats.css')
  script(src='https://cdn.jsdelivr.net/npm/chart.js')

block content
  .detailed-stats-container(lang=(uiLang || 'en'))
    a.btn(href="/dashboard")= t('detailedStats.nav.backToDashboard')

    h2= t('detailedStats.header.title')

    .stats-grid
      .stat-card
        h4= t('detailedStats.cards.totalBlocks')
        p.stat-number #{stats.totalBlocks}

      .stat-card
        h4= t('detailedStats.cards.collaborations')
        p.stat-number #{stats.totalCollaborations}

      .stat-card
        h4= t('detailedStats.cards.votesGiven')
        p.stat-number #{stats.totalVotesGiven}

      .stat-card
        h4= t('detailedStats.cards.daysActive')
        p.stat-number #{stats.daysActive}

    canvas#activityChart(width="400" height="300")

  script.
    const ctx = document.getElementById('activityChart').getContext('2d');
    new Chart(ctx, {
      type: 'bar',
      data: {
        labels: [
          '!{t("detailedStats.chart.labels.blocksCreated")}',
          '!{t("detailedStats.chart.labels.collaborations")}',
          '!{t("detailedStats.chart.labels.votesGiven")}',
          '!{t("detailedStats.chart.labels.daysActive")}'
        ],
        datasets: [{
          label: '!{t("detailedStats.chart.datasetLabel")}',
          data: [
            #{stats.totalBlocks},
            #{stats.totalCollaborations},
            #{stats.totalVotesGiven},
            #{stats.daysActive}
          ],
          backgroundColor: ['#69b3f2', '#70c9a9', '#ffd56b', '#ff9f40'],
        }]
      },
      options: {
        responsive: true,
        plugins: { legend: { display: false } },
        scales: {
          y: { beginAtZero: true },
          x: { ticks: { maxRotation: 45, minRotation: 45, autoSkip: false } }
        }
      }
    });
