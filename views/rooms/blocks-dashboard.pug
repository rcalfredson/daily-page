extends ../layout

include ../partials/_translation_attribution
include ../partials/_block_list
include ../partials/_read_more

block nav
  include ../navLinks

block append scripts
  script(src="/js/vote-controls.js")
  script(src='/js/modal.js')
  script(src="/js/block-tabs.js")
  script(src="/js/star-room.js")
  script(src='/js/adjust-date-margin.js')
  script(src='/js/table-scroll-fade.js')

block append head
  link(rel='stylesheet' href='/css/blocks-dashboard.css')
  link(rel="stylesheet" href="/css/blocks-tabs.css")
  link(rel="stylesheet" href="/css/vote-controls.css")
  link(rel="stylesheet" href="/css/modal.css")
  link(rel="stylesheet" href="/css/star-room.css")
  link(rel='stylesheet' href='/css/translation-attribution.css')
  link(rel='stylesheet' href='/css/table-scroll-fade.css')

prepend content
  // Instead of storing date in 'header', let's pass it as 'todayLabel' or something
  .room-header
    .room-header-row
      .title-line
        button.star-btn(
          data-room-id=room_id
          data-logged-in=user ? "true" : "false"
          class=isStarred ? "starred" : ""
          title=isStarred ? "Unstar this room" : "Star this room"
        )
          if isStarred
            // For Font Awesome 4, star is .fa .fa-star when starred
            i.fa.fa-star
          else
            // Outline star is .fa .fa-star-o
            i.fa.fa-star-o

        h1.room-name= roomMetadata.name

      // Smaller date text below
      if date
        p.room-date= date

  if roomMetadata && roomMetadata.description
    p#room-description= roomMetadata.description
  else
    p#room-description No description available.
  p.room-archive-link
    a(href=`/rooms/${room_id}/index`) üóÇÔ∏è All Blocks
  p.room-archive-link
    a(href=`/rooms/${room_id}/archive`) üóìÔ∏è Browse by Date
  p.room-archive-link
    a(href=`/rooms/${room_id}/archive/best-of`) üèÖ Best of this Room

append content
  include ../partials/_login_modal
  
  p
    a.btn(href=`/rooms/${room_id}/blocks/new`) Create a Block

  //- Tab links
  if useTabs
    .tabs
      ul.tab-links
        li(class="active")
          a(href="#locked-tab") Locked Blocks
        li
          a(href="#inprogress-tab") In-Progress Blocks

      //- Tab content for Locked Blocks
      .tab-content
        #locked-tab(class="active")
          if lockedBlocks.length
            +blockList(lockedBlocks, lockedPeriod, "Locked blocks", room_id)
          else
            p No locked blocks yet! Blocks auto-lock after 1 hour of inactivity.

        //- Tab content for In-Progress Blocks
        #inprogress-tab
          if inProgressBlocks.length
            +blockList(inProgressBlocks, inProgressPeriod, "In-progress blocks", room_id)
          else
            p No in-progress blocks yet! ¬°Manos a la obra!
  else
    if showLockedTab
      // T√≠tulo/periodo sin UI de tabs
      .tab-content
        #locked-tab.active
          +blockList(lockedBlocks, lockedPeriod, "Locked blocks", room_id)

    else if showInProgressTab
      .tab-content
        #inprogress-tab.active
          +blockList(inProgressBlocks, inProgressPeriod, "In-progress blocks", room_id)

    else
      p No blocks yet! Crea el primero y deja huella. üòé
